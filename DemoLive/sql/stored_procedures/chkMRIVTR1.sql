select * from spldata.mr_ivtrn where ivt_invno is not null and SUBSTRING(ivt_invno,1,1) in ('9','0') and  ivt_saltp='04' and isnull(ivt_stsfl,'')<>'X' and isnull(ivt_invqt,0)>0  and isnull(ivt_assvl,0)>0   and ivt_cmpcd + ivt_mkttp + ivt_invno + ivt_prdcd + ivt_pkgtp in (select ivt_cmpcd + ivt_mkttp + ivt_invno + ivt_prdcd + ivt_pkgtp from spldata.mr_ivtr1 where ivt_invno is not null and SUBSTRING(ivt_invno,1,1) in ('9','0') and  ivt_saltp='04' and isnull(ivt_assvl,0)=0);

update spldata.mr_ivtrn  set ivt_invno=ivt_invno where ivt_invno is not null and SUBSTRING(ivt_invno,1,1) in ('9','0') and  ivt_saltp='04' and isnull(ivt_stsfl,'')<>'X' and isnull(ivt_invqt,0)>0  and isnull(ivt_assvl,0)>0   and ivt_cmpcd + ivt_mkttp + ivt_invno + ivt_prdcd + ivt_pkgtp in (select ivt_cmpcd + ivt_mkttp + ivt_invno + ivt_prdcd + ivt_pkgtp from spldata.mr_ivtr1 where ivt_invno is not null and SUBSTRING(ivt_invno,1,1) in ('9','0') and  ivt_saltp='04' and isnull(ivt_assvl,0)=0);
commit;
